@extends(
    "brats.base.config"
    "assets/batch_iter/3d_patch.config"
	"assets/model/tnet3d.config"
	"assets/problem/segm.torch.config"
)

activation = torch_lib.nn.functional.relu

stride = 2

structure = [
    [[8],      [16, 32], [64, 64, 64, 16]],
    [[16, 16], [16,],    [32, 32]],
    [[32, 32], [32,],    [64, 32]],
    [[64, 64], [64,],    [128, 64]],
    [[64, 64, 64]]
]

torch_lib = meta:import(module="torch")

// Batch iter
x_patch_sizes = [[145, 177, 145]]
y_patch_size = [145, 177, 145]

optimize = torch_lib.optim.Adam
