from .assets.batch_iter.patch_3d_strat import *
from .brats_base import *
from .assets.model.deepmedic_els import *
from .assets.problem.segm import *

import torch

from dpipe.torch.utils import softmax, SoftmaxCrossEntropy
from dpipe.train.lr_policy import Decreasing

logits2pred = softmax
logits2loss = SoftmaxCrossEntropy(n_classes=n_chans_out)
optimize = torch.optim.Adam

x_patch_sizes = [[25, 25, 25], [57, 57, 57]]
y_patch_size = [9, 9, 9]

batch_size = 64

n_epochs = 120
n_iters_per_epoch = 100

lr_policy = Decreasing(
    atol=0.01,
    lr_dec_mul=0.5,
    lr_init=0.1,
    patience=5,
    rtol=0.02,
)

predictor_x_patch_sizes = [[106, 106, 106], [138, 138, 138]]
predictor_y_patch_size = [90, 90, 90]
